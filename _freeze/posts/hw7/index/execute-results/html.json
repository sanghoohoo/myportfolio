{
  "hash": "7d0abbefbf9a119adb2f5b7c3cef4397",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"HW7\"\nauthor: 'Sanghoo Ahn'\ndate: '2024-09-02'\ncategories: [bigdata]\njupyter: python3\n---\n\n\n## ADP 표본점수\n\n**2022년에 실시된 ADP실기 시험의 통계파트 표준점수는 평균이 30, 표준편차가 5인 정규분포를 따른다고 한다.**\n \n- ADP 실기 시험의 통계파트 표준점수의 밀도함수를 그려보세요\n\n::: {#87d767a7 .cell execution_count=1}\n``` {.python .cell-code}\nfrom scipy.stats import norm\nimport numpy as np\nimport matplotlib.pyplot as plt\nk = np.linspace(10, 50, 100)\ny = norm.pdf(k, loc=30, scale=5)\nplt.plot(k, y)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-2-output-1.png){width=579 height=411}\n:::\n:::\n\n\n- ADP 수험생을 임의로 1명을 선택하여 통계 점수를 조회했을때 45점 보다 높은 점수를 받았을 확률을 구하세요.\n\n::: {#e44836f9 .cell execution_count=2}\n``` {.python .cell-code}\np = 1-norm.cdf(45, loc=30, scale=5)\nprint(round(p, 6))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.00135\n```\n:::\n:::\n\n\n- 슬통이는 상위 10%에 해당하는 점수를 얻었다고 한다면, 슬통이의 점수는 얼마인지 계산해보세요.\n\n::: {#c6875123 .cell execution_count=3}\n``` {.python .cell-code}\nscore = norm.ppf(0.9, loc=30, scale=5)\nprint(round(score, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n36.408\n```\n:::\n:::\n\n\n- 슬기로운 통계생활의 해당 회차 수강생은 16명이었다고 한다. 16명의 통계 파트 점수를 평균내었을 때, 이 평균값이 따르는 분포의 확률밀도 함수를 1번의 그래프와 겹쳐 그려보세요.\n\n::: {#559f757d .cell execution_count=4}\n``` {.python .cell-code}\nk = np.linspace(10, 50, 100)\ny = norm.pdf(k, loc=30, scale=5)\nplt.plot(k, y)\n\nX_bar = norm.pdf(k, loc=30, scale=5/np.sqrt(16))\nplt.plot(k, X_bar)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-1.png){width=579 height=411}\n:::\n:::\n\n\n-슬기로운 통계생활 ADP 반 수강생들의 통계점수를 평균내었다고 할 때, 이 값이 38점보다 높게 나올 확률을 구하세요.\n\n::: {#343a362a .cell execution_count=5}\n``` {.python .cell-code}\np = 1-norm.cdf(38, loc=30, scale=5/np.sqrt(16))\nprint(p)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n7.76885222819601e-11\n```\n:::\n:::\n\n\n## Covid 19 발병률\n\n**Covid‑19의 발병률은 1%라고 한다. 다음은 이번 코로나 사태로 인하여 코로나 의심 환자들 1,085명을 대상으로 슬통 회사의 “다잡아” 키트를 사용하여 양성 반응을 체크한 결과이다.**\n\n::: {#0cb38560 .cell execution_count=6}\n``` {.python .cell-code}\nimport pandas as pd\npd.DataFrame({\n    \"키트\\실제\": [\"양성\", \"음성\"],\n    \"양성\": [370, 15],\n    \"음성\": [10, 690]\n})\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>키트\\실제</th>\n      <th>양성</th>\n      <th>음성</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>양성</td>\n      <td>370</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>음성</td>\n      <td>15</td>\n      <td>690</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n- 다잡아 키트가 코로나 바이러스에 걸린 사람을 양성으로 잡아낼 확률을 계산하세요.\n\n::: {#6db0781d .cell execution_count=7}\n``` {.python .cell-code}\n# P(키트 양성|실제 양성)\np = 370 / (370 + 15)\nprint(round(p, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.961\n```\n:::\n:::\n\n\n- 슬통 회사에서 다잡아 키트를 사용해 양성으로 나온 사람이 실제로는 코로나 바이러스에 걸려있을 확률을 97%라며, 키트의 우수성을 주장했다. 이 주장이 옳지 않은 이유를 서술하세요.\n\n```\n표본집단의 확률인 0.961038961038961과 차이가 큼\n\n```\n\n- Covid‑19 발병률을 사용하여, 키트의 결과값이 양성으로 나온 사람이 실제로 코로나 바이러스에 걸려있을 확률을 구하세요.\n\n$$\n\\begin{aligned}\nP(\\text{실제 양성} \\mid \\text{키트 양성}) &= \\frac{P(\\text{키트 양성} \\cap \\text{실제 양성})}{P(\\text{키트 양성})} \\\\\n&= \\frac{P(\\text{실제 양성}) \\cdot P(\\text{키트 양성} \\mid \\text{실제 양성})}\n{P(\\text{실제 양성}) \\cdot P(\\text{키트 양성} \\mid \\text{실제 양성}) + P(\\text{실제 음성}) \\cdot P(\\text{키트 양성} \\mid \\text{실제 음성})}\n\\end{aligned}\n$$\n\n::: {#f609170c .cell execution_count=8}\n``` {.python .cell-code}\np = 0.01*(370/385) / (0.01*(370/385)+0.99*(10/700))\nprint(round(p, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.405\n```\n:::\n:::\n\n\n## 카이제곱분포와 표본분산\n\n- 자유도가 4인 카이제곱분포의 확률밀도함수를 그려보세요.\n\n::: {#60408dfd .cell execution_count=9}\n``` {.python .cell-code}\nfrom scipy.stats import chi2\nk = np.linspace(0, 20, 100)\ny = chi2.pdf(k, df=4)\nplt.plot(k, y)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-10-output-1.png){width=587 height=411}\n:::\n:::\n\n\n- 다음의 확률을 구해보세요. 𝑃 (3 ≤ 𝑋 ≤ 5)\n\n::: {#81f0b800 .cell execution_count=10}\n``` {.python .cell-code}\np = chi2.cdf(5, df=4) - chi2.cdf(3, df=4)\nprint(round(p, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.271\n```\n:::\n:::\n\n\n- 자유도가 4인 카이제곱분포에서 크기가 1000인 표본을 뽑은 후, 히스토그램을 그려보세요.\n\n::: {#efea50a2 .cell execution_count=11}\n``` {.python .cell-code}\nimport seaborn as sns\nnp.random.seed(20240902)\nx=chi2.rvs(size=1000, df=4)\nsns.histplot(x)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-12-output-1.png){width=593 height=411}\n:::\n:::\n\n\n- 자유도가 4인 카이제곱분포를 따르는 확률변수에서 나올 수 있는 값 중 상위 5%에 해당하는 값은 얼마인지 계산해보세요.\n\n::: {#0df2d022 .cell execution_count=12}\n``` {.python .cell-code}\nx = chi2.ppf(0.95, df=4)\nprint(round(x, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n9.488\n```\n:::\n:::\n\n\n- 3번에서 뽑힌 표본값들 중 상위 5%에 위치한 표본의 값은 얼마인가요?\n\n::: {#70a4916a .cell execution_count=13}\n``` {.python .cell-code}\nx = np.percentile(x, 95)\nprint(round(x, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n9.488\n```\n:::\n:::\n\n\n- 평균이 3, 표준편차가 2인 정규분포를 따르는 확률변수에서 크기가 20인 표본, x_1, ..., x_20,을 뽑은 후 표본분산을 계산한 것을 s^2_1이라 생각해보죠. 다음을 수행해보세요!\n\n::: {#77043848 .cell execution_count=14}\n``` {.python .cell-code}\n# 같은 방법으로 500개의 s^2 들, s^2_1,s^2_2,...,s^2_500 발생시킵니다.\nvar=[]\nfor i in range(500):\n    x=norm.rvs(size=20, loc=3, scale=2)\n    var.append(np.var(x, ddof=1))\n```\n:::\n\n\n::: {#d0513510 .cell execution_count=15}\n``` {.python .cell-code}\n# 발생한 500개의 s^2 들 각각에 4.75를 곱하고, 그것들의 히스토그램을 그려보세요. (히스토그램을 그릴 때 probability = TRUE 옵션을 사용해서 그릴 것)\na=np.array(var)*4.75\nsns.histplot(a, stat=\"probability\")\n# 위에서 그린 히스토그램에 자유도가 19인 카이제곱분포 확률밀도함수를 겹쳐그려보세요.\nk = np.linspace(a.min(), a.max(), 100)\ny = chi2.pdf(k, df=19)\nplt.plot(k, y, color='red')\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-16-output-1.png){width=597 height=411}\n:::\n:::\n\n\n<div id=\"disqus_thread\"></div>\n<script>\nvar disqus_config = function () {\n    this.page.url = window.location.href;  // 현재 페이지 URL\n    this.page.identifier = window.location.pathname; // 페이지 고유 식별자\n};\n\n(function() { // DON'T EDIT BELOW THIS LINE\n    var d = document, s = d.createElement('script');\n    s.src = 'https://sanghoohoo.disqus.com/embed.js';\n    s.setAttribute('data-timestamp', +new Date());\n    (d.head || d.body).appendChild(s);\n})();\n</script>\n<noscript>Please enable JavaScript to view the <a href=\"https://disqus.com/?ref_noscript\">comments powered by Disqus.</a></noscript>\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}