{
  "hash": "10eb91883b773fd539676842975881eb",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"HW1\"\nauthor: 'Sanghoo Ahn'\ndate: '2024-07-12'\ncategories: [bigdata]\njupyter: python3\n---\n\n\n**다음 표의 내용을 데이터 프레임으로 만들어 출력해 보세요. (p.85)**\n\n::: {#2b50e16a .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\ndf=pd.DataFrame({\n    '제품':['사과','딸기','수박'],\n    '가격':[1800,1500,3000],\n    '판매량':[24,38,13]\n})\nprint(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   제품    가격  판매량\n0  사과  1800   24\n1  딸기  1500   38\n2  수박  3000   13\n```\n:::\n:::\n\n\n**mpg데이터 변수명 변경 (p.115)**\n\n::: {#501bff88 .cell execution_count=2}\n``` {.python .cell-code}\nmpg=pd.read_csv('C:/Users/USER/Documents/LS빅데이터스쿨/myportfolio/data/mpg.csv')\nmpg_new=mpg.copy()\nmpg_new=mpg_new.rename(columns={'cty':'city'})\nmpg_new=mpg_new.rename(columns={'hwy':'highway'})\nprint(mpg_new)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    manufacturer   model  displ  year  cyl       trans drv  city  highway fl  \\\n0           audi      a4    1.8  1999    4    auto(l5)   f    18       29  p   \n1           audi      a4    1.8  1999    4  manual(m5)   f    21       29  p   \n2           audi      a4    2.0  2008    4  manual(m6)   f    20       31  p   \n3           audi      a4    2.0  2008    4    auto(av)   f    21       30  p   \n4           audi      a4    2.8  1999    6    auto(l5)   f    16       26  p   \n..           ...     ...    ...   ...  ...         ...  ..   ...      ... ..   \n229   volkswagen  passat    2.0  2008    4    auto(s6)   f    19       28  p   \n230   volkswagen  passat    2.0  2008    4  manual(m6)   f    21       29  p   \n231   volkswagen  passat    2.8  1999    6    auto(l5)   f    16       26  p   \n232   volkswagen  passat    2.8  1999    6  manual(m5)   f    18       26  p   \n233   volkswagen  passat    3.6  2008    6    auto(s6)   f    17       26  p   \n\n    category  \n0    compact  \n1    compact  \n2    compact  \n3    compact  \n4    compact  \n..       ...  \n229  midsize  \n230  midsize  \n231  midsize  \n232  midsize  \n233  midsize  \n\n[234 rows x 11 columns]\n```\n:::\n:::\n\n\n**midway.csv를 불러와 데이터의 특징을 파악하세요. (p.130)**\n\n::: {#d117b4ef .cell execution_count=3}\n``` {.python .cell-code}\nmdw=pd.read_csv('C:/Users/USER/Documents/LS빅데이터스쿨/myportfolio/data/midwest.csv')\nmdw.describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>PID</th>\n      <th>area</th>\n      <th>poptotal</th>\n      <th>popdensity</th>\n      <th>popwhite</th>\n      <th>popblack</th>\n      <th>popamerindian</th>\n      <th>popasian</th>\n      <th>popother</th>\n      <th>percwhite</th>\n      <th>...</th>\n      <th>perchsd</th>\n      <th>percollege</th>\n      <th>percprof</th>\n      <th>poppovertyknown</th>\n      <th>percpovertyknown</th>\n      <th>percbelowpoverty</th>\n      <th>percchildbelowpovert</th>\n      <th>percadultpoverty</th>\n      <th>percelderlypoverty</th>\n      <th>inmetro</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>437.000000</td>\n      <td>437.000000</td>\n      <td>4.370000e+02</td>\n      <td>437.000000</td>\n      <td>4.370000e+02</td>\n      <td>4.370000e+02</td>\n      <td>437.000000</td>\n      <td>437.000000</td>\n      <td>437.000000</td>\n      <td>437.000000</td>\n      <td>...</td>\n      <td>437.000000</td>\n      <td>437.000000</td>\n      <td>437.000000</td>\n      <td>4.370000e+02</td>\n      <td>437.000000</td>\n      <td>437.000000</td>\n      <td>437.000000</td>\n      <td>437.000000</td>\n      <td>437.000000</td>\n      <td>437.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>1437.338673</td>\n      <td>0.033169</td>\n      <td>9.613030e+04</td>\n      <td>3097.742985</td>\n      <td>8.183992e+04</td>\n      <td>1.102388e+04</td>\n      <td>343.109840</td>\n      <td>1310.464531</td>\n      <td>1612.931350</td>\n      <td>95.558441</td>\n      <td>...</td>\n      <td>73.965546</td>\n      <td>18.272736</td>\n      <td>4.447259</td>\n      <td>9.364228e+04</td>\n      <td>97.110267</td>\n      <td>12.510505</td>\n      <td>16.447464</td>\n      <td>10.918798</td>\n      <td>11.389043</td>\n      <td>0.343249</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>876.390266</td>\n      <td>0.014679</td>\n      <td>2.981705e+05</td>\n      <td>7664.751786</td>\n      <td>2.001966e+05</td>\n      <td>7.895827e+04</td>\n      <td>868.926751</td>\n      <td>9518.394189</td>\n      <td>18526.540699</td>\n      <td>7.087358</td>\n      <td>...</td>\n      <td>5.843177</td>\n      <td>6.261908</td>\n      <td>2.408427</td>\n      <td>2.932351e+05</td>\n      <td>2.749863</td>\n      <td>5.150155</td>\n      <td>7.228634</td>\n      <td>5.109166</td>\n      <td>3.661259</td>\n      <td>0.475338</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>561.000000</td>\n      <td>0.005000</td>\n      <td>1.701000e+03</td>\n      <td>85.050000</td>\n      <td>4.160000e+02</td>\n      <td>0.000000e+00</td>\n      <td>4.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>10.694087</td>\n      <td>...</td>\n      <td>46.912261</td>\n      <td>7.336108</td>\n      <td>0.520291</td>\n      <td>1.696000e+03</td>\n      <td>80.902441</td>\n      <td>2.180168</td>\n      <td>1.918955</td>\n      <td>1.938504</td>\n      <td>3.547067</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>670.000000</td>\n      <td>0.024000</td>\n      <td>1.884000e+04</td>\n      <td>622.407407</td>\n      <td>1.863000e+04</td>\n      <td>2.900000e+01</td>\n      <td>44.000000</td>\n      <td>35.000000</td>\n      <td>20.000000</td>\n      <td>94.886032</td>\n      <td>...</td>\n      <td>71.325329</td>\n      <td>14.113725</td>\n      <td>2.997957</td>\n      <td>1.836400e+04</td>\n      <td>96.894572</td>\n      <td>9.198715</td>\n      <td>11.624088</td>\n      <td>7.668009</td>\n      <td>8.911763</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>1221.000000</td>\n      <td>0.030000</td>\n      <td>3.532400e+04</td>\n      <td>1156.208330</td>\n      <td>3.447100e+04</td>\n      <td>2.010000e+02</td>\n      <td>94.000000</td>\n      <td>102.000000</td>\n      <td>66.000000</td>\n      <td>98.032742</td>\n      <td>...</td>\n      <td>74.246891</td>\n      <td>16.797562</td>\n      <td>3.814239</td>\n      <td>3.378800e+04</td>\n      <td>98.169562</td>\n      <td>11.822313</td>\n      <td>15.270164</td>\n      <td>10.007610</td>\n      <td>10.869119</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>2059.000000</td>\n      <td>0.038000</td>\n      <td>7.565100e+04</td>\n      <td>2330.000000</td>\n      <td>7.296800e+04</td>\n      <td>1.291000e+03</td>\n      <td>288.000000</td>\n      <td>401.000000</td>\n      <td>345.000000</td>\n      <td>99.074935</td>\n      <td>...</td>\n      <td>77.195345</td>\n      <td>20.549893</td>\n      <td>4.949324</td>\n      <td>7.284000e+04</td>\n      <td>98.598636</td>\n      <td>15.133226</td>\n      <td>20.351878</td>\n      <td>13.182182</td>\n      <td>13.412162</td>\n      <td>1.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>3052.000000</td>\n      <td>0.110000</td>\n      <td>5.105067e+06</td>\n      <td>88018.396600</td>\n      <td>3.204947e+06</td>\n      <td>1.317147e+06</td>\n      <td>10289.000000</td>\n      <td>188565.000000</td>\n      <td>384119.000000</td>\n      <td>99.822821</td>\n      <td>...</td>\n      <td>88.898674</td>\n      <td>48.078510</td>\n      <td>20.791321</td>\n      <td>5.023523e+06</td>\n      <td>99.860384</td>\n      <td>48.691099</td>\n      <td>64.308477</td>\n      <td>43.312464</td>\n      <td>31.161972</td>\n      <td>1.000000</td>\n    </tr>\n  </tbody>\n</table>\n<p>8 rows × 25 columns</p>\n</div>\n```\n:::\n:::\n\n\n**poptotal(전체 인구) 변수를 total로, popasian(아시아 인구) 변수를 asian으로 수정하세요.**\n\n::: {#b38fc4fa .cell execution_count=4}\n``` {.python .cell-code}\nmdw=mdw.rename(columns={'poptotal':'total'})\nmdw=mdw.rename(columns={'popasian':'asian'})\nprint(mdw[['total','asian']])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      total  asian\n0     66090    249\n1     10626     48\n2     14991     16\n3     30806    150\n4      5836      5\n..      ...    ...\n432  304715   2699\n433   46104     92\n434   19385     43\n435  140320   1728\n436   73605    722\n\n[437 rows x 2 columns]\n```\n:::\n:::\n\n\n**total,asian 변수를 이용해 '전체 인구 대비 아시아 인구 백분율' 파생변수를 추가하고, 히스토그램을 만들어 분포를 살펴보세요.**\n\n::: {#ad3c7f78 .cell execution_count=5}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\nmdw['per_asian']=mdw['asian']/mdw['total']*100\nprint(mdw)\nmdw['per_asian'].hist()\nplt.show()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      PID     county state   area   total   popdensity  popwhite  popblack  \\\n0     561      ADAMS    IL  0.052   66090  1270.961540     63917      1702   \n1     562  ALEXANDER    IL  0.014   10626   759.000000      7054      3496   \n2     563       BOND    IL  0.022   14991   681.409091     14477       429   \n3     564      BOONE    IL  0.017   30806  1812.117650     29344       127   \n4     565      BROWN    IL  0.018    5836   324.222222      5264       547   \n..    ...        ...   ...    ...     ...          ...       ...       ...   \n432  3048   WAUKESHA    WI  0.034  304715  8962.205880    298313      1096   \n433  3049    WAUPACA    WI  0.045   46104  1024.533330     45695        22   \n434  3050   WAUSHARA    WI  0.037   19385   523.918919     19094        29   \n435  3051  WINNEBAGO    WI  0.035  140320  4009.142860    136822       697   \n436  3052       WOOD    WI  0.048   73605  1533.437500     72157        90   \n\n     popamerindian  asian  ...  percprof  poppovertyknown  percpovertyknown  \\\n0               98    249  ...  4.355859            63628         96.274777   \n1               19     48  ...  2.870315            10529         99.087145   \n2               35     16  ...  4.488572            14235         94.956974   \n3               46    150  ...  4.197800            30337         98.477569   \n4               14      5  ...  3.367680             4815         82.505140   \n..             ...    ...  ...       ...              ...               ...   \n432            672   2699  ...  7.667090           299802         98.387674   \n433            125     92  ...  3.138596            44412         96.330036   \n434             70     43  ...  2.620907            19163         98.854785   \n435            685   1728  ...  5.659847           133950         95.460376   \n436            481    722  ...  4.583725            72685         98.750085   \n\n     percbelowpoverty  percchildbelowpovert  percadultpoverty  \\\n0           13.151443             18.011717         11.009776   \n1           32.244278             45.826514         27.385647   \n2           12.068844             14.036061         10.852090   \n3            7.209019             11.179536          5.536013   \n4           13.520249             13.022889         11.143211   \n..                ...                   ...               ...   \n432          3.121060              3.785820          2.590061   \n433          8.488697             10.071411          6.953799   \n434         13.786985             20.050708         11.695784   \n435          8.804031             10.592031          8.660587   \n436          8.525831             11.162997          7.375656   \n\n     percelderlypoverty  inmetro  category  per_asian  \n0             12.443812        0       AAR   0.376759  \n1             25.228976        0       LHR   0.451722  \n2             12.697410        0       AAR   0.106731  \n3              6.217047        1       ALU   0.486918  \n4             19.200000        0       AAR   0.085675  \n..                  ...      ...       ...        ...  \n432            4.085479        1       HLU   0.885746  \n433           10.338641        0       AAR   0.199549  \n434           11.804558        0       AAR   0.221821  \n435            6.661094        1       HAU   1.231471  \n436            7.882918        0       AAR   0.980912  \n\n[437 rows x 29 columns]\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-6-output-2.png){width=575 height=411}\n:::\n:::\n\n\n**아시아 인구 백분율 전체 평균을 구하고, 평균을 초과하면 'Large', 그 외에는 'Small'을 부여한 파생변수를 만들어 보세요.**\n\n::: {#e0adfb2c .cell execution_count=6}\n``` {.python .cell-code}\nimport numpy as np\navg_asian=mdw['per_asian'].mean()\nmdw['amo_asian']=np.where((mdw['per_asian']>avg_asian),'Large','Small')\nprint(mdw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      PID     county state   area   total   popdensity  popwhite  popblack  \\\n0     561      ADAMS    IL  0.052   66090  1270.961540     63917      1702   \n1     562  ALEXANDER    IL  0.014   10626   759.000000      7054      3496   \n2     563       BOND    IL  0.022   14991   681.409091     14477       429   \n3     564      BOONE    IL  0.017   30806  1812.117650     29344       127   \n4     565      BROWN    IL  0.018    5836   324.222222      5264       547   \n..    ...        ...   ...    ...     ...          ...       ...       ...   \n432  3048   WAUKESHA    WI  0.034  304715  8962.205880    298313      1096   \n433  3049    WAUPACA    WI  0.045   46104  1024.533330     45695        22   \n434  3050   WAUSHARA    WI  0.037   19385   523.918919     19094        29   \n435  3051  WINNEBAGO    WI  0.035  140320  4009.142860    136822       697   \n436  3052       WOOD    WI  0.048   73605  1533.437500     72157        90   \n\n     popamerindian  asian  ...  poppovertyknown  percpovertyknown  \\\n0               98    249  ...            63628         96.274777   \n1               19     48  ...            10529         99.087145   \n2               35     16  ...            14235         94.956974   \n3               46    150  ...            30337         98.477569   \n4               14      5  ...             4815         82.505140   \n..             ...    ...  ...              ...               ...   \n432            672   2699  ...           299802         98.387674   \n433            125     92  ...            44412         96.330036   \n434             70     43  ...            19163         98.854785   \n435            685   1728  ...           133950         95.460376   \n436            481    722  ...            72685         98.750085   \n\n     percbelowpoverty  percchildbelowpovert  percadultpoverty  \\\n0           13.151443             18.011717         11.009776   \n1           32.244278             45.826514         27.385647   \n2           12.068844             14.036061         10.852090   \n3            7.209019             11.179536          5.536013   \n4           13.520249             13.022889         11.143211   \n..                ...                   ...               ...   \n432          3.121060              3.785820          2.590061   \n433          8.488697             10.071411          6.953799   \n434         13.786985             20.050708         11.695784   \n435          8.804031             10.592031          8.660587   \n436          8.525831             11.162997          7.375656   \n\n     percelderlypoverty  inmetro  category  per_asian  amo_asian  \n0             12.443812        0       AAR   0.376759      Small  \n1             25.228976        0       LHR   0.451722      Small  \n2             12.697410        0       AAR   0.106731      Small  \n3              6.217047        1       ALU   0.486918      Small  \n4             19.200000        0       AAR   0.085675      Small  \n..                  ...      ...       ...        ...        ...  \n432            4.085479        1       HLU   0.885746      Large  \n433           10.338641        0       AAR   0.199549      Small  \n434           11.804558        0       AAR   0.221821      Small  \n435            6.661094        1       HAU   1.231471      Large  \n436            7.882918        0       AAR   0.980912      Large  \n\n[437 rows x 30 columns]\n```\n:::\n:::\n\n\n**'Large'와 'Small'에 해당하는 지역이 얼마나 많은지 빈도표와 빈도 막대 그래프를 만들어 확인해 보세요.**\n\n::: {#5ee33557 .cell execution_count=7}\n``` {.python .cell-code}\nplt.clf()\nasian_counts=mdw['amo_asian'].value_counts()\nprint(asian_counts)\nasian_counts.plot.bar(rot=0)\nplt.show()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\namo_asian\nSmall    318\nLarge    119\nName: count, dtype: int64\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-8-output-2.png){width=575 height=429}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}