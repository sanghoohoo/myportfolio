---
title: "ê³„ì ˆë³„ í™”ì¬ë°œìƒ ë¹ˆë„ ë° ìš”ì¸ ë¶„ì„"
author: "ëª…ì˜ˆì†Œë°©ê´€ ì‹œì¼œì¡°ğŸš’ : ì•ˆìƒí›„, ì˜¤ì„œì—°, ê¹€ì£¼ì˜, ê¹€ì¬í¬"
format: html
editor: visual
categories: [LS bigdata]
jupyter: python3
---

<br>

## 0. ì£¼ì œ ì„ ì • ì´ìœ 

> í™”ì¬ì— ì˜í•œ í”¼í•´ ê°ì†Œë¥¼ ìœ„í•´<br> **í™”ì¬ê°€ ë§ì´ ë°œìƒí•˜ëŠ” ê³„ì ˆ**, **í™”ì¬ ë°œìƒì— ë§ì´ ê¸°ì—¬í•˜ëŠ” ìš”ì¸**, **ì¸ëª…í”¼í•´ê°€ ë§ì´ ë°œìƒí•˜ëŠ” ìš”ì¸**ì„<br> ë¶„ì„í•˜ì—¬ ì˜ˆë°©ì±… ì œì•ˆ

## 1. ê³„ì ˆë³„ í™”ì¬ë°œìƒ ë¹ˆë„

### <ë°ì´í„° ì„¤ëª…>

```{python}
import pandas as pd
import numpy as np
df = pd.read_csv("../data/fire.csv")
df.head()
```

<br>

### <ë°ì´í„° ì „ì²˜ë¦¬>

-   ì—°ë„ë³„ë¡œ ë¶„ë¦¬

```{python}
data_2020 = df[['í•­ëª©'] + df.filter(like='2020').columns.tolist()]

data_2021 = df[['í•­ëª©'] + df.filter(like='2021').columns.tolist()]

data_2022 = df[['í•­ëª©'] + df.filter(like='2022').columns.tolist()]

data_2022.head()
```

<br>

-   2022ë…„ì˜ ì œí’ˆê²°í•¨ ì—´ ì‚­ì œ

```{python}
data_2022 = data_2022.drop(columns = "2022.11")
data_2022.head()
```

<br>

-   0ë²ˆì§¸ í–‰ì„ columnìœ¼ë¡œ ì§€ì •

```{python}
data_2020.columns = data_2020.iloc[0] 

data_2021.columns = data_2021.iloc[0] 

data_2022.columns = data_2022.iloc[0] 

data_2022.head()
```

<br>

-   0í–‰, 1í–‰ ì‚­ì œ í›„ ì¸ë±ìŠ¤ ì´ˆê¸°í™”

```{python}
data_2020 = data_2020[2:]
data_2020 = data_2020.reset_index(drop=True)

data_2021 = data_2021[2:]
data_2021 = data_2021.reset_index(drop=True)

data_2022 = data_2022[2:]
data_2022 = data_2022.reset_index(drop=True)

data_2022.head()
```

<br>

-   ë°ì´í„°íƒ€ì…ì´ objectë¡œ ë˜ì–´ ìˆìŒ

```{python}
data_2022.info()
```

<br>

-   forë¬¸ì„ ì‚¬ìš©í•´ ë°ì´í„°íƒ€ì…ì„ intë¡œ ë³€ê²½

```{python}
columns_to_convert = ['ê³„', 'ì „ê¸°ì ìš”ì¸', 'ê¸°ê³„ì ìš”ì¸',
                'í™”í•™ì ìš”ì¸', 'ê°€ìŠ¤ëˆ„ì¶œ', 'êµí†µì‚¬ê³ ', 'ë¶€ì£¼ì˜', 'ê¸°íƒ€',
                'ìì—°ì ìš”ì¸', 'ë°©í™”', 'ë°©í™”ì˜ì‹¬', 'ë¯¸ìƒ']

for column in columns_to_convert:
    data_2020[column] = pd.to_numeric(data_2020[column])

for column in columns_to_convert:
    data_2021[column] = pd.to_numeric(data_2021[column])

for column in columns_to_convert:
    data_2022[column] = pd.to_numeric(data_2022[column])

data_2022.info()
```

<br>

-   ê³„ì ˆ íŒŒìƒë³€ìˆ˜ ì¶”ê°€

    > ë´„: 3ì›”, 4ì›”, 5ì›”<br> ì—¬ë¦„: 6ì›”, 7ì›”, 8ì›”<br> ê°€ì„: 9ì›”, 10ì›”, 11ì›”<br> ê²¨ìš¸: 12ì›”, 1ì›”, 2ì›”

```{python}
data_2020["ê³„ì ˆ"] = np.where(data_2020["í•­ëª©"]\
                    .isin(["3ì›”", "4ì›”", "5ì›”"]),"spring",
                    np.where(data_2020["í•­ëª©"]\
                    .isin(["6ì›”", "7ì›”", "8ì›”"]),"summer",
                    np.where(data_2020["í•­ëª©"]\
                    .isin(["9ì›”", "10ì›”", "11ì›”"]),"fall","winter")))

data_2021["ê³„ì ˆ"] = np.where(data_2021["í•­ëª©"]\
                    .isin(["3ì›”", "4ì›”", "5ì›”"]),"spring",
                    np.where(data_2021["í•­ëª©"].\
                    isin(["6ì›”", "7ì›”", "8ì›”"]),"summer",
                    np.where(data_2021["í•­ëª©"].\
                    isin(["9ì›”", "10ì›”", "11ì›”"]),"fall","winter")))

data_2022["ê³„ì ˆ"] = np.where(data_2022["í•­ëª©"]\
                    .isin(["3ì›”", "4ì›”", "5ì›”"]),"spring",
                    np.where(data_2022["í•­ëª©"]\
                    .isin(["6ì›”", "7ì›”", "8ì›”"]),"summer",
                    np.where(data_2022["í•­ëª©"]\
                    .isin(["9ì›”", "10ì›”", "11ì›”"]),"fall","winter")))

data_2022.head()
```

<br>

-   ê³„ì ˆë³„ í™”ì¬ íšŸìˆ˜ ë°ì´í„°í”„ë ˆì„ ìƒì„±

```{python}
season_20 = data_2020.groupby('ê³„ì ˆ').agg(sum2020=('ê³„','sum'))

season_21 = data_2021.groupby('ê³„ì ˆ').agg(sum2021=('ê³„','sum'))

season_22 = data_2022.groupby('ê³„ì ˆ').agg(sum2022=('ê³„','sum'))

season_22
```

<br>

-   ë°ì´í„° í•©ì¹˜ê¸° ('concat' í•¨ìˆ˜ì´ìš©)

```{python}
season = pd.concat([season_20,season_21,season_22], axis=1)
season
```

<br>

-   ê³„ì ˆ ìˆœì„œë¥¼ 'ë´„', 'ì—¬ë¦„', 'ê°€ì„', 'ê²¨ìš¸'ë¡œ ì •ë ¬

```{python}
season = season.loc[['spring', 'summer', 'fall', 'winter']]
season
```

<br>

### <ë°ì´í„° ì‹œê°í™”>

-   ê³„ì ˆë³„ í™”ì¬ë°œìƒ ì„  ê·¸ë˜í”„ ìƒì„±

```{python}
import matplotlib.pyplot as plt

plt.figure(figsize=(6, 6))
plt.plot(season.index, season['sum2020'], marker='o', label='2020')
plt.plot(season.index, season['sum2021'], marker='o', label='2021')
plt.plot(season.index, season['sum2022'], marker='o', label='2022')

plt.legend()
plt.show()
plt.clf()
```

<br>

### <ê²°ê³¼ >

> 2020ë…„, 2021ë…„, 2022ë…„ ëª¨ë‘ ì—¬ë¦„ê³¼ ê°€ì„ì— ë¹„í•´<br>**ë´„**ê³¼ **ê²¨ìš¸**ì— í™”ì¬ ë°œìƒ ë¹ˆë„ê°€ ë†’ê²Œ ë‚˜íƒ€ë‚¨

<br>

## 2. ìš”ì¸ë³„ í™”ì¬ë°œìƒ ë¹ˆë„

### <ë°ì´í„° ì „ì²˜ë¦¬>

-   ë‹¤ì‹œ í•œë²ˆ ë°ì´í„° í™•ì¸í•´ë³´ê¸° <br>

```{python}
data_2022.head
```

<br>

-   ë°ì´í„° í•©ì¹˜ê¸° ('concat' í•¨ìˆ˜ì´ìš©)

```{python}
data_all = pd.concat([data_2020, data_2021,data_2022])
data_all
```

<br>

-   í•„ìš”ì—†ëŠ” ì—´ ì œê±°

```{python}
data_all = data_all.drop(columns=['ê³„'])
data_all.head(3)
```

<br>

-   ìš”ì¸ë³„ í‰ê·  ë‚´ê¸°

```{python}
# í–‰ê³¼ ì—´ ë°”ê¿”ì¤Œ
data_all = data_all.transpose()
data_all.head()
```

```{python}
# í•„ìš”ì—†ëŠ” ì—´ ì œê±°
data_all = data_all.drop("í•­ëª©", axis=0)
data_all = data_all.drop("ê³„ì ˆ", axis=0)
data_all.head()
```

```{python}
# ë°ì´í„°íƒ€ì…ì´ objectë¡œ ë˜ì–´ ìˆìŒ
data_all.info()
```

<br>

```{python}
# ë°ì´í„°íƒ€ì…ì„ intë¡œ ë³€ê²½
data_all=data_all.astype(int)
data_all.info()
```

<br>

-   1ë…„ë™ì•ˆ ì¼ì–´ë‚˜ëŠ” ìš”ì¸ë³„ í™”ì¬ê±´ìˆ˜ë¥¼ 'total'ì—´ ìƒì„±(3ë…„ í‰ê· )

```{python}
data_all["total"] = data_all.sum(axis=1)/3
data_all.head()
```

```{python}
## í•œê¸€
from matplotlib import font_manager, rc

# í•œê¸€ í°íŠ¸ ì„¤ì •
font_path = "C:/Windows/Fonts/malgun.ttf"  # ì˜ˆì‹œ: ìœˆë„ìš° ì‹œìŠ¤í…œì— ìˆëŠ” ë§‘ì€ ê³ ë”• í°íŠ¸ ê²½ë¡œ
font_name = font_manager.FontProperties(fname=font_path).get_name()
rc('font', family=font_name)
```

### <ë°ì´í„° ì‹œê°í™”>

-   ìš”ì¸ë³„ í™”ì¬ê±´ìˆ˜

```{python}
data_all["total"].plot.bar(rot=0)
plt.xticks(fontsize=7, rotation=45)
plt.show()
plt.clf()
```

<br>

### <ê²°ê³¼>

> 3ë…„ê°„ í™”ì¬ë°œìƒ ìš”ì¸ì˜ í‰ê· ì„ ë¶„ì„í–ˆì„ ë•Œ **ë¶€ì£¼ì˜**ê°€ ê°€ì¥ ë†’ê²Œ ë‚˜íƒ€ë‚¨

<br>

## 3. ìš”ì¸ë³„ ì¸ëª…í”¼í•´

### <ë°ì´í„° ì„¤ëª…>

```{python}
damage = pd.read_csv("../data/di.csv")
damage

```

<br>

### <ë°ì´í„° ì „ì²˜ë¦¬>

-   ì—°ë„ë³„ë¡œ ë¶„ë¦¬

```{python}
damage_20 = damage[['í•­ëª©'] + damage.filter(like='2020').columns.tolist()]
damage_21 = damage[['í•­ëª©'] + damage.filter(like='2021').columns.tolist()]
damage_22 = damage[['í•­ëª©'] + damage.filter(like='2022').columns.tolist()]

damage_22.head()
```

```         
<br>
```

-   í–‰ ì˜¬ë¦¬ê¸° (ë°˜ë³µë˜ëŠ” ê¸°ì¡´ ì—´ ì‚­ì œ ë° ì²«ë²ˆì§¸ í–‰ ì˜¬ë¦¬ê¸°)

```{python}

damage_20.columns = damage_20.iloc[0]
damage_20 = damage_20[1:3]
damage_20 = damage_20.reset_index(drop=True)
damage_20 = damage_20.drop(columns=['í•­ëª©','ê³„'])

damage_21.columns = damage_21.iloc[0]
damage_21 = damage_21[1:3]
damage_21 = damage_21.reset_index(drop=True)
damage_21 = damage_21.drop(columns=['í•­ëª©','ê³„'])

damage_22.columns = damage_22.iloc[0]
damage_22 = damage_22[1:3]
damage_22 = damage_22.reset_index(drop=True)
damage_22 = damage_22.drop(columns=['í•­ëª©', 'ê³„', 'ì œí’ˆê²°í•¨'])

damage_22
```

<br>

-   í–‰ì—´ ì „í™˜

```{python}
damage_20 = damage_20.transpose()

damage_21 = damage_21.transpose()

damage_22 = damage_22.transpose()

damage_22.head()

```

<br>

-   ë°ì´í„° í•©ì¹˜ê¸° ('concat' í•¨ìˆ˜ì´ìš©)

```{python}
damage_total = pd.concat([damage_20, damage_21[1], damage_22[1]], axis=1)
    
damage_total = damage_total.drop(0, axis=1)
    
damage_total.head()
```

<br>

-   ê³„ì‚° ê°€ëŠ¥í•œ ìˆ«ìí˜• ë°ì´í„°ë¡œ ì „í™˜í•˜ê¸°

```{python}
damage_total=damage_total.astype(int)
damage_total.info()
```

<br>

-   ì‚¬ë§ ë°ì´í„° ë¶„ë¥˜í•˜ê¸°

```{python}
death = damage_total.iloc[::2]
death
```

<br>

-   ë¶€ìƒ ë°ì´í„° ë¶„ë¥˜í•˜ê¸°

```{python}
injury = damage_total.iloc[1::2]
injury
```

<br>

-   ì‚¬ë§,ë¶€ìƒë³„ í•©ê³„ ,í‰ê·  ë³€ìˆ˜ ë° ë°±ë¶„ìœ¨ ë³€ìˆ˜ ì¶”ê°€í•˜ê¸°

```{python}
death_all = death.assign(total = death.sum(axis = 1),
                         mean = lambda x : x["total"] / 3 ,
                         ratio = lambda x : (x["mean"] / data_all["total"]) * 100)

injury_all = injury.assign(total = injury.sum(axis = 1),
                           mean = lambda x : x["total"] / 3,
                           ratio = lambda x : (x["mean"] / data_all["total"]) * 100)
             
injury_all.head()
                               
```

<br>

### <ë°ì´í„° ì‹œê°í™”>

-   ì´ í™”ì¬ ë°œìƒ ëŒ€ë¹„ ì‚¬ë§ë¥  ë§‰ëŒ€ ê·¸ë˜í”„ ìƒì„±

```{python}
death_all["ratio"].plot.bar(rot=0)
plt.xticks(fontsize=7, rotation=20)
plt.show()
plt.clf()
    
```

> (ì—°ê°„ ì‚¬ë§ íšŸìˆ˜ í‰ê· /ì—°ê°„ í™”ì¬ ë°œìƒ íšŸìˆ˜ í‰ê· \*100) \[%\]

<br>

-   ì´ í™”ì¬ ë°œìƒ ëŒ€ë¹„ ë¶€ìƒë¥  ë§‰ëŒ€ ê·¸ë˜í”„ ìƒì„±

```{python}
injury_all["ratio"].plot.bar(rot=0)
plt.xticks(fontsize=7, rotation=20)
plt.show()
plt.clf()

```

> (ì—°ê°„ ë¶€ìƒ íšŸìˆ˜ í‰ê· /ì—°ê°„ í™”ì¬ ë°œìƒ íšŸìˆ˜ í‰ê· \*100) \[%\]

<br>

### <ê²°ê³¼>

> ì‚¬ë§ë¥ ì€ **ë°©í™”**ì™€ **ë°©í™” ì˜ì‹¬**,<br> ë¶€ìƒë¥ ì€ **ê°€ìŠ¤ëˆ„ì¶œ**ì´ ë†’ê²Œ ë‚˜íƒ€ë‚¨

## 4. ê²°ë¡ 

-   ê±´ì¡°í•œ ë‚ ì”¨ì™€ ë‚œë°©ê¸°êµ¬ ì‚¬ìš©ìœ¼ë¡œ í™”ì¬ê°€ ë§ì´ ë°œìƒí•˜ëŠ”<br> **ë´„ê³¼ ê²¨ìš¸ì— íŠ¹íˆ ì£¼ì˜**ê°€ í•„ìš”í•¨<br>

-   í™”ì¬ ë°œìƒì˜ ì£¼ìš” ì›ì¸ì´ ë¶€ì£¼ì˜ì¸ ì ì„ ê°ì•ˆí•  ë•Œ,<br> **í™”ì¬ ì˜ˆë°©ì„ ìœ„í•œ ëŒ€ì¤‘ êµìœ¡ê³¼ ìº í˜ì¸**ì´ ì¤‘ìš”í•¨<br>

-   ë°©í™” ë° ë°©í™” ì˜ì‹¬ í™”ì¬ì— ì˜í•œ ì‚¬ë§ì´ ë§ìœ¼ë¯€ë¡œ<br> **ê³ ì˜ì ì¸ í™”ì¬ì— ëŒ€í•œ ê°•ë ¥í•œ ë²•ì  ëŒ€ì‘ê³¼ ì˜ˆë°©ì±…**ì„ ë§ˆë ¨í•´ì•¼ í•¨<br>

-   ê°€ìŠ¤ ëˆ„ì¶œ í™”ì¬ì— ì˜í•œ ë¶€ìƒì´ ë§ìœ¼ë¯€ë¡œ<br> **ê°€ìŠ¤ ì•ˆì „ ê´€ë¦¬ì™€ ê´€ë ¨ëœ ë²•ê·œì™€ êµìœ¡**ì„ ê°•í™”í•  í•„ìš”ê°€ ìˆìŒ<br>
